
{
    "swagger": "2.0",
    "info": {
        "description": "ルール用機能（トリガー／オペレーション／AND設定生成・削除・設定情報取得）を提供するAPI。",
        "version": "1.0.0",
        "title": "Rule Profile"
    },
    "basePath": "/gotapi/rule",
    "consumes": ["application/x-www-form-urlencoded", "multipart/form-data"],
    "paths": {
        "/andRule": {
            "post": {
                "summary": "AND用ルールサービスにAND条件を設定する。",
                "description": "",
                "operationId": "rulePostAndRule",
                "parameters": [
                    {
                        "name": "serviceId",
                        "in": "formData",
                        "description": "ルールを識別するためのserviceId。",
                        "required": true,
                        "type": "string"
                    }, 
                    {
                        "name": "andRuleServiceId",
                        "in": "formData",
                        "description": "AND条件のruleServiceId<br>ANDの条件とするruleServiceId<br>(カンマ区切りで条件分)",
                        "required": true,
                        "type": "string"
                    }, 
                    {
                        "name": "judgementTime",
                        "in": "formData",
                        "description": "判定時間<br>ND条件成立を待機する時間。",
                        "required": true,
                        "type": "number"
                    }, 
                    {
                        "name": "judgementTimeUnit",
                        "in": "formData",
                        "description": "判定時間単位。<br>デフォルトはmSec",
                        "required": false,
                        "type": "string",
                        "enum": ["mSec", "second", "minute", "hour", "day"]
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/RuleAndRuleResponse"
                        },
                        "examples": {
                            "application/json": {
                                "result": 0,
                                "product": "Example System",
                                "version": "1.0.0"
                            }
                        }
                    }
                },
                "x-type": "one-shot"
            }
        },
        "/onOperation": {
            "get": {
                "summary": "ルール判定の状態を取得する。",
                "description": "",
                "operationId": "ruleGetStatus",
                "parameters": [
                    {
                        "name": "serviceId",
                        "in": "query",
                        "description": "ルールを識別するためのサービスID。",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/RuleGetStatusResponse"
                        },
                        "examples": {
                            "application/json": {
                                "result": 0,
                                "product": "Example System",
                                "version": "1.0.0",
                                "ruleEnable": true
                            }
                        }
                    }
                },
                "x-type": "one-shot"
            },
            "put": {
                "summary": "ルール判定の開始を行う。",
                "description": "",
                "operationId": "rulePutStart",
                "parameters": [
                    {
                        "name": "serviceId",
                        "in": "query",
                        "description": "ルールを識別するためのserviceId",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/RulePutStartResponse"
                        },
                        "examples": {
                            "application/json": {
                                "result": 0,
                                "product": "Example System",
                                "version": "1.0.0"
                            }
                        }
                    }
                },
                "x-type": "event"
            },
            "delete": {
                "summary": "ルール判定の停止を行う。",
                "description": "",
                "operationId": "ruleDeleteStop",
                "parameters": [
                    {
                        "name": "serviceId",
                        "in": "query",
                        "description": "ルールを識別するためのserviceId",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/RuleDeleteStopResponse"
                        },
                        "examples": {
                            "application/json": {
                                "result": 0,
                                "product": "Example System",
                                "version": "1.0.0"
                            }
                        }
                    }
                },
                "x-type": "event"
            }
        },
        "/operation": {
            "post": {
                "summary": "ルール成立後の動作を設定する。",
                "description": "",
                "operationId": "rulePostOperation",
                "parameters": [
                    {
                        "name": "serviceId",
                        "in": "formData",
                        "description": "ルールを識別するためのserviceId。",
                        "required": true,
                        "type": "string"
                    }, 
                    {
                        "name": "operationIndex",
                        "in": "formData",
                        "description": "オペレーションインデックス<br>既設内容を変更する場合に設定<br>省略時は新規設定として扱う",
                        "required": false,
                        "type": "number"
                    }, 
                    {
                        "name": "operation",
                        "in": "formData",
                        "description": "オペレーション<br>トリガー条件成立時のオペレーションREST URI。",
                        "required": false,
                        "type": "string"
                    }, 
                    {
                        "name": "operationAction",
                        "in": "formData",
                        "description": "オペレーションアクション<br>オペレーション条件RESTのアクション。",
                        "required": false,
                        "type": "string",
                        "enum": ["GET", "POST", "PUT", "DELETE"]
                    }, 
                    {
                        "name": "operationParameter",
                        "in": "formData",
                        "description": "オペレーションパラメータ<br>オペレーション条件RESTのパラメータ。",
                        "required": false,
                        "type": "string"
                    }, 
                    {
                        "name": "delayOccurrence",
                        "in": "formData",
                        "description": "処理遅延発生時の次回処理<br>オペレーション実行中に新たに実行要求が行われた場合の処理対応設定。<br>省略時はskip。",
                        "required": false,
                        "type": "string",
                        "enum": ["skip", "stack"]
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/RuleSetOpetarionResponse"
                        },
                        "examples": {
                            "application/json": {
                                "result": 0,
                                "operationIndex": 1,
                                "product": "Example System",
                                "version": "1.0.0"
                            }
                        }
                    }
                },
                "x-type": "one-shot"
            },
            "delete": {
                "summary": "ルール成立後の動作を削除する。",
                "description": "",
                "operationId": "ruleDeleteOperation",
                "parameters": [
                    {
                        "name": "serviceId",
                        "in": "query",
                        "description": "ルールを識別するためのserviceId",
                        "required": true,
                        "type": "string"
                    }, 
                    {
                        "name": "operationIndex",
                        "in": "formData",
                        "description": "オペレーションインデックス<br>既設内容を変更する場合に設定<br>省略時は新規設定として扱う",
                        "required": false,
                        "type": "number"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/RuleDeleteOpetarionResponse"
                        },
                        "examples": {
                            "application/json": {
                                "result": 0,
                                "product": "Example System",
                                "version": "1.0.0"
                            }
                        }
                    }
                },
                "x-type": "one-shot"
            }
        },
        "/trigger": {
            "post": {
                "summary": "ルール成立のトリガーを設定する。",
                "description": "",
                "operationId": "rulePostTrigger",
                "parameters": [
                    {
                        "name": "serviceId",
                        "in": "formData",
                        "description": "ルールを識別するためのserviceId。",
                        "required": true,
                        "type": "string"
                    }, 
                    {
                        "name": "triggerInterval",
                        "in": "formData",
                        "description": "トリガーインターバル<br>トリガー条件のRESTを実行する間隔<br>省略時はルール開始後即発動。",
                        "required": false,
                        "type": "number"
                    }, 
                    {
                        "name": "triggerIntervalUnit",
                        "in": "formData",
                        "description": "トリガーインターバル単位。<br>デフォルトはmSec",
                        "required": true,
                        "type": "string",
                        "enum": ["mSec", "second", "minute", "hour", "day"]
                    }, 
                    {
                        "name": "trigger",
                        "in": "formData",
                        "description": "トリガー条件<br>トリガー条件を取得するサービスをREST URIにて記載<br>「Date&Time」記述時はDate&Time設定として動作。",
                        "required": false,
                        "type": "string"
                    }, 
                    {
                        "name": "triggerAction",
                        "in": "formData",
                        "description": "トリガーアクション<br>トリガー条件RESTのアクション。",
                        "required": false,
                        "type": "string",
                        "enum": ["GET", "POST", "PUT", "DELETE"]
                    }, 
                    {
                        "name": "triggerParameter",
                        "in": "formData",
                        "description": "トリガーパラメータ<br>トリガー条件RESTのパラメータ。",
                        "required": false,
                        "type": "string"
                    }, 
                    {
                        "name": "comparisonLeft",
                        "in": "formData",
                        "description": "比較値 (左辺)<br>比較条件の左辺に該当する値。",
                        "required": false,
                        "type": "string"
                    }, 
                    {
                        "name": "comparisonLeftDataType",
                        "in": "formData",
                        "description": "比較条件の左辺に該当する値のデータタイプ。",
                        "required": false,
                        "type": "string"
                    }, 
                    {
                        "name": "comparison",
                        "in": "formData",
                        "description": "比較条件<br>トリガー条件比較演算子<br>省略時はトリガー条件取得後即時被悪条件成立と判断。",
                        "required": false,
                        "type": "string"
                    }, 
                    {
                        "name": "comparisonRight",
                        "in": "formData",
                        "description": "比較値 (右辺)<br>比較条件の右辺に該当する値。",
                        "required": false,
                        "type": "string"
                    }, 
                    {
                        "name": "comparisonRightDataType",
                        "in": "formData",
                        "description": "比較条件の右辺に該当する値のデータタイプ。",
                        "required": false,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/RuleSetTriggerResponse"
                        },
                        "examples": {
                            "application/json": {
                                "result": 0,
                                "product": "Example System",
                                "version": "1.0.0"
                            }
                        }
                    }
                },
                "x-type": "one-shot"
            },
            "delete": {
                "summary": "ルール成立のトリガーを削除する。",
                "description": "",
                "operationId": "ruleDeleteTrigger",
                "parameters": [
                    {
                        "name": "serviceId",
                        "in": "query",
                        "description": "ルールを識別するためのserviceId",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/RuleDeleteTriggerResponse"
                        },
                        "examples": {
                            "application/json": {
                                "result": 0,
                                "product": "Example System",
                                "version": "1.0.0"
                            }
                        }
                    }
                },
                "x-type": "one-shot"
            }
        },
        "/triggerInterval": {
            "post": {
                "summary": "トリガーインターバルを設定する。",
                "description": "",
                "operationId": "rulePostTriggerInterval",
                "parameters": [
                    {
                        "name": "serviceId",
                        "in": "formData",
                        "description": "ルールを識別するためのserviceId。",
                        "required": true,
                        "type": "string"
                    }, 
                    {
                        "name": "triggerInterval",
                        "in": "formData",
                        "description": "トリガーインターバル<br>トリガー条件のRESTを実行する間隔",
                        "required": true,
                        "type": "number"
                    }, 
                    {
                        "name": "triggerIntervalUnit",
                        "in": "formData",
                        "description": "トリガーインターバル単位。<br>デフォルトはmSec",
                        "required": false,
                        "type": "string",
                        "enum": ["mSec", "second", "minute", "hour", "day"]
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/RuleTriggerIntervalResponse"
                        },
                        "examples": {
                            "application/json": {
                                "result": 0,
                                "product": "Example System",
                                "version": "1.0.0"
                            }
                        }
                    }
                },
                "x-type": "one-shot"
            }
        },
        "/description": {
            "post": {
                "summary": "ルール詳細説明を設定する。",
                "description": "",
                "operationId": "rulePostDescription",
                "parameters": [
                    {
                        "name": "serviceId",
                        "in": "formData",
                        "description": "ルールを識別するためのserviceId。",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "description",
                        "in": "formData",
                        "description": "ルール詳細説明",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/RuleDescription"
                        },
                        "examples": {
                            "application/json": {
                                "result": 0,
                                "product": "Example System",
                                "version": "1.0.0"
                            }
                        }
                    }
                },
                "x-type": "one-shot"
            }
        }
    },
    "definitions": {
        "Status": {
            "type": "object",
            "required": ["ruleEnable"],
            "properties": {
                "ruleEnable": {
                    "type": "boolean",
                    "description": "ルールの有効／無効を示す。",
                    "title": "ルール動作状態"
                }
            }
        },
        "OperationResponse": {
            "type": "object",
            "required": ["operationIndex"],
            "properties": {
                "operationIndex": {
                    "type": "number",
                    "description": "設定または更新されたオペレーションインデックス。",
                    "title": "オペレーションインデックス"
                }
            }
        },
        "RuleGetStatusResponse": {
            "allOf": [
                {
                    "$ref": "#/definitions/CommonResponse"
                }, 
                {
                    "$ref": "#/definitions/Status"
                }
            ]
        },
        "RulePutStartResponse": {
            "allOf": [
                {
                    "$ref": "#/definitions/CommonResponse"
                }
            ]
        },
        "RuleDeleteStopResponse": {
            "allOf": [
                {
                    "$ref": "#/definitions/CommonResponse"
                }
            ]
        },
        "RuleSetTriggerResponse": {
            "allOf": [
                {
                    "$ref": "#/definitions/CommonResponse"
                }
            ]
        },
        "RuleDeleteTriggerResponse": {
            "allOf": [
                {
                    "$ref": "#/definitions/CommonResponse"
                }
            ]
        },
        "RuleSetOpetarionResponse": {
            "allOf": [
                {
                    "$ref": "#/definitions/CommonResponse"
                }, 
                {
                    "$ref": "#/definitions/OperationResponse"
                }
            ]
        },
        "RuleDeleteOpetarionResponse": {
            "allOf": [
                {
                    "$ref": "#/definitions/CommonResponse"
                }
            ]
        },
        "RuleTriggerIntervalResponse": {
            "allOf": [
                {
                    "$ref": "#/definitions/CommonResponse"
                }
            ]
        },
        "RuleAndRuleResponse": {
            "allOf": [
                {
                    "$ref": "#/definitions/CommonResponse"
                }
            ]
        },
        "RuleDescription": {
            "allOf": [
                {
                    "$ref": "#/definitions/CommonResponse"
                }
            ]
        },
        "CommonResponse": {
            "type": "object",
            "required": ["product", "result", "version"],
            "properties": {
                "result": {
                    "type": "integer",
                    "description": "0: 正常応答<br>0以外: 異常応答",
                    "title": "処理結果"
                },
                "product": {
                    "type": "string",
                    "description": "DeviceConnectシステムの名前。",
                    "title": "システム名"
                },
                "version": {
                    "type": "string",
                    "description": "DeviceConnectシステムのバージョン名。",
                    "title": "システムバージョン"
                },
                "hmac": {
                    "type": "string",
                    "description": "レスポンスに対する署名。アプリケーション側から事前にHMACキーを共有されていた場合は必須。",
                    "title": "署名"
                }
            }
        }
    }
}